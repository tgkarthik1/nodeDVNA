var express = require('express');
var DVNA = express();

DVNA.get('/evaluate', function(request, response) {
  var response = eval("("+request.query.e+")");
  response.send('Parameter eval():<br> ' + response);
});

DVNA.get('/build_function', function(request, response) {
  // Another instance of the same vulnerability but in this instance we build a function instead of evaluating a parameter value
  var invokeCustomFunction = new Function("create", request.query.e);
  var isVulnerable = true;
  var functionCallReturn = invokeCustomFunction(isVulnerable);
  response.send('Invoke our custom function: ' + functionCallReturn);
});

module.exports = {
  title: 'Remote Code Execution (RCE)',
  server: DVNA
}